<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<!--<link id="favicon" rel="icon" href="" type="image/x-icon">-->
    <title>Giveaway Manager</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #212121;
            color: #f0f0f0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        .wrapper {
            display: flex;
            justify-content: center;
            width: 90%;
            max-width: 1300px;
            gap: 60px;
            align-items: stretch;
        }

        .container {
            background-color: #2d2d2d;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            flex: 1;
            max-width: 460px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            height: 100%;
        }

        .bottom-box {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 80px;
            background-color: #2d2d2d;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            max-width: 1300px;
            width: 750px;
            box-sizing: border-box;
            flex-wrap: wrap;
            justify-content: space-between;
        }

        .bottom-box .title {
            color: #fff;
            font-size: 32px;
            font-weight: bold;
            margin: 0;
        }

        .side-button {
            width: 200px;
            height: 48px;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
            margin: 0;
            transition: none;
        }

        .side-button.green {
            background-color: #28a745;
        }

        .side-button.red {
            background-color: #dc3545;
        }

        h1 {
            text-align: center;
            color: #fff;
            margin-bottom: 20px;
        }

        label {
            font-weight: bold;
            margin-bottom: 5px;
            display: block;
            color: #ddd;
        }

        input,
        select,
        textarea {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #444;
            border-radius: 5px;
            font-size: 16px;
            color: #fff;
            background-color: #333;
            box-sizing: border-box;
        }

        textarea {
            resize: none;
            height: 40px;
            overflow-y: auto;
        }

        input:focus,
        select:focus,
        textarea:focus {
            border-color: #0a84ff;
            outline: none;
        }

        .fields-group {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }

        .fields-group > div {
            flex: 1;
            margin-right: 20px;
        }

        .fields-group > div:last-child {
            margin-right: 0;
        }

        button {
            width: 100%;
            padding: 12px;
            background-color: #0a84ff;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 15px;
        }

        button:hover {
            background-color: #0061c2;
        }

        .button-group {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            margin-top: 5px;
            margin-bottom: 10px;
        }

        .button-group button {
            flex: 1;
        }

        #popup {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            padding: 15px 25px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
            font-size: 16px;
            color: white;
            display: none;
        }

        #popup.success {
            background-color: #28a745;
        }

        #popup.error {
            background-color: #dc3545;
        }

        #checkerWinnersList {
            height: 118px;
            margin-top: 3px;
        }

        #copyButton  {
            margin-top: 20px;
        }

        #checkerCopyBtn {
            margin-top: 16px;
        }

        #checkerToggleFormat.on {
            background-color: #28a745;
        }

        #checkerToggleFormat.off {
            background-color: #dc3545;
        }

        #checkerRunBtn {
            background-color: #ffcc00;
            color: #000;
        }

        #checkerRunBtn:hover {
            background-color: #e6b800;
        }

        select {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: none;
        }

        select:focus {
            border-color: #0a84ff;
            outline: none;
        }

        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type="number"] {
            -moz-appearance: textfield;
        }

        #checkerDataInput,
        #checkerWinnersList {
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        #checkerDataInput::-webkit-scrollbar,
        #checkerWinnersList::-webkit-scrollbar {
            display: none;
        }

        a.bookmarklet-button {
            text-decoration: none;
            display: inline-block;
            width: 200px;
            height: 48px;
            color: white;
            border-radius: 5px;
            font-size: 18px;
            line-height: 48px;
            text-align: center;
            background-color: #28a745;
            cursor: grab;
        }

        a.bookmarklet-button:active {
            cursor: grabbing;
        }

        #disclaimerOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 9998;
        }

        #disclaimerModal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #333;
            color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
            font-size: 16px;
            width: 600px;
            height: 650px;
            display: none;
            flex-direction: column;
            justify-content: space-between;
            box-sizing: border-box;
            z-index: 9999;
        }

        #disclaimerModal p {
            font-size: 18px;
            line-height: 1.6;
            max-height: 80vh;
            overflow-y: auto;
        }

        #closeDisclaimerBtn {
            background-color: #dc3545;
            color: white;
            font-size: 18px;
            padding: 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="wrapper">
        <div class="container">
            <h1>Multi-Giveaway Tool</h1>

            <label for="groupID">Group ID:</label>
            <input type="number" id="groupID" placeholder="Enter Group ID" min="1">

            <div class="fields-group">
                <div>
                    <label for="credits">Credits:</label>
                    <input type="number" id="credits" placeholder="Enter Credits" min="0">
                </div>
                <div>
                    <label for="bits">Bits:</label>
                    <input type="number" id="bits" placeholder="Enter Bits" min="0">
                </div>
            </div>

            <div class="fields-group">
                <div>
                    <label for="time">Days:</label>
                    <input type="number" id="time" placeholder="Enter Days" min="1" max="7">
                </div>
                <div>
                    <label for="quantity">Quantity:</label>
                    <input type="number" id="quantity" placeholder="Enter Quantity" min="1">
                </div>
            </div>

            <div class="fields-group">
                <div>
                    <label for="fundingSource">Funding Source:</label>
                    <select id="fundingSource">
                        <option value="1">Personal Wallet</option>
                        <option value="2">Group Wallet</option>
                    </select>
                </div>
                <div>
                    <label for="giveawayAccess">Giveaway Access:</label>
                    <select id="giveawayAccess">
                        <option value="2" selected>Only Members</option>
                        <option value="1">Everyone</option>
                    </select>
                </div>
            </div>

            <button id="copyButton" onclick="generateCode()">Copy to Clipboard</button>
        </div>

        <div class="container">
            <h1>Giveaway Winner Checker</h1>

            <label for="checkerDataInput" class="label-style">Paste Giveaway Data:</label>
            <textarea id="checkerDataInput" placeholder="Paste your giveaway data here..."></textarea>

            <div class="button-group">
                <button id="checkerRunBtn" onclick="runWinnerChecker()">Check Winners</button>
                <button id="checkerToggleFormat" class="off" onclick="toggleWinnerFormatting()">Discord Formatting</button>
            </div>

            <div class="fields-group">
                <div>
                    <label for="checkerWinnersList" id="checkerWinnerCount">Total Winners: 0</label>
                    <textarea id="checkerWinnersList" readonly></textarea>
                </div>
            </div>

            <button id="checkerCopyBtn" onclick="copyWinnersToClipboard()">Copy to Clipboard</button>
        </div>
    </div>

    <div class="bottom-box">
        <a id="bookmarkletLink"
           class="bookmarklet-button"
           href="javascript:(()=>{const forms=document.querySelectorAll('form[action*=&quot;/enter-giveaway&quot;]');if(!forms.length)return alert(&quot;Error: No Giveaways Found&quot;);if(!confirm(`Found ${forms.length} giveaways, would you like to enter them all?`))return;if(forms.length>=50){alert(&quot;Please stay on this page and do not refresh until all giveaways have been entered&quot;);}const delay=ms=>new Promise(resolve=>setTimeout(resolve,ms));let label,progress;if(forms.length>=50){const statusBox=document.createElement(&quot;div&quot;);statusBox.style.cssText=&quot;position:fixed;left:250px;top:100px;z-index:9999;background:#333;color:#fff;padding:10px 15px;border-radius:8px;font-family:sans-serif;box-shadow:0 0 10px rgba(0,0,0,0.5);width:400px;box-sizing:border-box;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;&quot;;label=document.createElement(&quot;div&quot;);label.textContent=&quot;Starting...&quot;;progress=document.createElement(&quot;progress&quot;);progress.style.cssText=&quot;width:100%;height:20px;margin-top:10px;&quot;;progress.setAttribute(&quot;max&quot;,&quot;100&quot;);progress.setAttribute(&quot;value&quot;,&quot;0&quot;);statusBox.appendChild(label);statusBox.appendChild(progress);document.body.appendChild(statusBox);}const enterGiveaways=async()=>{if(label)label.textContent=&quot;Entering Giveaways...&quot;;let count=0;for(let i=0;i&lt;forms.length;i++){const form=forms[i];const action=form.getAttribute('action');const formData=new FormData(form);fetch(action,{method:'POST',body:formData,credentials:'same-origin'}).catch(()=>{});count++;if(progress)progress.setAttribute(&quot;value&quot;,(count/forms.length)*100);await delay(1);if(label&amp;&amp;count%50===0&amp;&amp;i&lt;forms.length-1){label.textContent=&quot;Pausing to prevent rate-limiting...&quot;;await delay(40000);label.textContent=&quot;Entering Giveaways...&quot;;}}if(label){label.textContent=&quot;Finalizing...&quot;;await delay(40000);}location.reload();alert(`${forms.length} giveaway${forms.length!==1?'s':''} entered, refreshing the page...`);if(label)label.textContent=&quot;Success! Refreshing the page...&quot;;};enterGiveaways();})();"
           title="Drag this to your bookmarks bar | CTRL + SHIFT + B"
           draggable="true" 
           ondragstart="event.dataTransfer.setData('text/plain', '');"> 
           Enter All
        </a>
        <h1 class="title">Enter All Button</h1>
        <button class="side-button red" onclick="showDisclaimer()">Disclaimer</button>
    </div>

    <div id="popup"></div>

<div id="disclaimerOverlay" onclick="hideDisclaimer()"></div>
    <!-- Disclaimer Modal -->
    <div id="disclaimerModal">
	    <h1>Disclaimer</h1>
	    <h2>Attention</h2>
            <p>This tool is not 100% reliable simply due to the nature of what it's doing, please verify that the tool has actually entered you into them<br><br>In extreme cases, running a modified version of this tool can result in your account being moderated, do not modify this tool</p2><br><br>
	    <h2>How to Use</h2>
            <p>Drag the "Enter All" button to your bookmarks bar, then click the bookmarklet (bookmark that runs code) on a page with active giveaways you can join</p>
            <button id="closeDisclaimerBtn" onclick="hideDisclaimer()">Close</button>
    </div>

    <script>
        let popupTimeout;

        function generateCode() {
            const groupID = document.getElementById("groupID").value;
            const bits = document.getElementById("bits").value;
            const credits = document.getElementById("credits").value;
            const time = document.getElementById("time").value;
            const quantity = document.getElementById("quantity").value;
            const fundingSource = document.getElementById("fundingSource").value;
            const giveawayAccess = document.getElementById("giveawayAccess").value;

            if (!groupID || !bits || !credits || !time || !quantity) {
                showPopup("All fields must be filled out", "error");
                return;
            }
            if (groupID <= 0 || !Number.isInteger(Number(groupID))) {
                showPopup("Group ID must be a positive integer", "error");
                return;
            }
            if (bits < 0 || !Number.isInteger(Number(bits))) {
                showPopup("Bits must be a positive integer", "error");
                return;
            }
            if (credits < 0 || !Number.isInteger(Number(credits))) {
                showPopup("Credits must be a positive integer", "error");
                return;
            }
            if (Number(credits) === 0 && Number(bits) === 0) {
                showPopup("Credits and Bits cannot both be 0", "error");
                return;
            }
            if (time < 1 || time > 7 || !Number.isInteger(Number(time))) {
                showPopup("Days must be between 1 and 7", "error");
                return;
            }
            if (quantity <= 0 || !Number.isInteger(Number(quantity))) {
                showPopup("Quantity must be a positive integer", "error");
                return;
            }

            const code = `
    (async () => {
        const token = document.querySelector('input[name="_token"]').value;

        for (let i = 0; i < ${quantity}; i++) {
            await fetch(\`https://www.brickplanet.com/groups/settings/${groupID}/new-currency-giveaway\`, {
                method: "POST",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: new URLSearchParams({
                    _token: token,
                    credits: ${credits},
                    bits: ${bits},
                    fundingSource: ${fundingSource},
                    giveawayAccess: ${giveawayAccess},
                    time: ${time}
                })
            });
            console.log(\`Giveaway \${i + 1} Created\`);

            if (i < ${quantity} - 1) await new Promise(resolve => setTimeout(resolve, 1000));
            if ((i + 1) % 9 === 0 && (i + 1) < ${quantity}) {
                console.log("Pausing for 12 seconds...");
                await new Promise(resolve => setTimeout(resolve, 12000));
            }
        }

        await new Promise(resolve => setTimeout(resolve, 1000));
        console.log("${quantity} Giveaway${quantity > 1 ? 's' : ''} Successfully Created!");
    })();`;

            const outputArea = document.createElement("textarea");
            outputArea.value = code;
            outputArea.style.width = "100%";
            outputArea.style.height = "200px";
            document.body.appendChild(outputArea);
            outputArea.select();
            document.execCommand("copy");
            document.body.removeChild(outputArea);
            showPopup("Paste this into BrickPlanet's Console (CTRL + SHIFT + I)", "success");
        }

        function showPopup(message, type) {
            const popup = document.getElementById("popup");
            popup.textContent = message;
            popup.className = type;
            popup.style.display = "block";

            clearTimeout(popupTimeout);
            popupTimeout = setTimeout(() => popup.style.display = "none", 3000);
        }

        let checkerFormattingEnabled = false;

        function parseWinnerData(data) {
            const winnerRegex = /Winner: (.+)/g;
            const winners = [];
            let match;

            while ((match = winnerRegex.exec(data)) !== null) {
                winners.push(match[1]);
            }

            return winners.reverse();
        }

        function getWinnerCounts(winnerArray) {
            const counts = {};
            winnerArray.forEach(name => {
                counts[name] = (counts[name] || 0) + 1;
            });
            return counts;
        }

        function sortWinners(countMap) {
            return Object.entries(countMap).sort((a, b) => b[1] - a[1]);
        }

        function getTotalWinnerCount(countMap) {
            return Object.values(countMap).reduce((acc, val) => acc + val, 0);
        }

        function toggleWinnerFormatting() {
            checkerFormattingEnabled = !checkerFormattingEnabled;
            const toggleBtn = document.getElementById("checkerToggleFormat");

            toggleBtn.classList.toggle("on", checkerFormattingEnabled);
            toggleBtn.classList.toggle("off", !checkerFormattingEnabled);

            runWinnerChecker();
        }

        function runWinnerChecker() {
            const rawData = document.getElementById("checkerDataInput").value;
            const winners = parseWinnerData(rawData);
            const winnerCounts = getWinnerCounts(winners);
            const sorted = sortWinners(winnerCounts);
            const total = getTotalWinnerCount(winnerCounts);
            const listContainer = document.getElementById("checkerWinnersList");
            const countLabel = document.getElementById("checkerWinnerCount");

            countLabel.textContent = `Total Winners: ${total}`;

            const displayList = [];

            sorted.forEach(([name, count]) => {
                if (checkerFormattingEnabled) {
                    let formatted = `*${name}*`;
                    if (count > 1) formatted += ` **x${count}**`;
                    displayList.push(formatted);
                } else {
                    let formatted = `${name}`;
                    if (count > 1) formatted += ` x${count}`;
                    displayList.push(formatted);
                }
            });

            listContainer.value = displayList.join(', ');
        }

        function copyWinnersToClipboard() {
            const winnersList = document.getElementById("checkerWinnersList").value;
            if (winnersList) {
                const outputArea = document.createElement("textarea");
                outputArea.value = winnersList;
                document.body.appendChild(outputArea);
                outputArea.select();
                document.execCommand("copy");
                document.body.removeChild(outputArea);
                showPopup("Winners List successfully copied to clipboard", "success");
            } else {
                showPopup("Cannot copy a blank Winners List", "error");
            }
        }

function showDisclaimer() {
    document.getElementById("disclaimerModal").style.display = "flex";
    document.getElementById("disclaimerOverlay").style.display = "block";
}

function hideDisclaimer() {
    document.getElementById("disclaimerModal").style.display = "none";
    document.getElementById("disclaimerOverlay").style.display = "none";
}

        document.getElementById('bookmarkletLink').addEventListener('click', function (e) {
            e.preventDefault();
            showPopup("Drag this button to your Bookmarks Bar (CTRL + SHIFT + B)", "error");
        });
    </script>
</body>
</html>